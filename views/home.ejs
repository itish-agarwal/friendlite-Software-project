<link rel="stylesheet" href="/css/home.css">
<link rel="stylesheet" href="/css/chat_box.css">

    <% if(locals.user) { %>
      <div id = "home-container">
       <div id="dashboard-div">

        <div id="me-container">
          <div id="dp-container">
            <img src="<%=locals.user.avatar%>">
          </div>
          <div id="name-container">
            <span> 
              <a href="/users/profile/<%= locals.user.id %>">
                <%= locals.user.name %>
              </a>
            </span>
          </div>
        </div>

        <div id="menu-name-container">
          <span>
            MENUS
          </span>
        </div>

        <div id="menu-div">


          <div class="item">
            <a href="#" class="a-tag-link active">
              <div class="icon-div">
                <i class="fas fa-home">

                </i>
              </div>
              <div class="actual-option">
                <span>
                  Newsfeed
                </span>
              </div>
            </a>
          </div>


          <div class="item">
            <a href="/users/posts/<%= locals.user.id %>" class="a-tag-link">
              <div class="icon-div">
                <i class="fas fa-envelope-open">

                </i>
              </div>
              <div class="actual-option">
                <span>
                  My posts
                </span>
              </div>
            </a>
          </div>


          <div class="item">
            <a href="#" class="a-tag-link">
              <div class="icon-div">
                <i class ="fas fa-user-friends">

                </i>
              </div>
              <div class="actual-option">
                <span>
                  Friends
                </span>
              </div>
            </a>
          </div>

          <div class="item">
            <a href="/users/profile/<%=locals.user.id%>" class="a-tag-link">
              <div class="icon-div">
                <i class ="fas fa-address-card">

                </i>
              </div>
              <div class="actual-option">
                <span>
                  My profile
                </span>
              </div>
            </a>
          </div>

          <div class="item">
            <a href="/users/sign-out" class="a-tag-link">
              <div class="icon-div">
                <i class="fas fa-door-open">

                </i>
              </div>
              <div class="actual-option">
                <span>
                  Sign Out
                </span>
              </div>
            </a>
          </div>


        </div>


       </div>
       <!--dashboard-div ends here-->




       <div id="feed-posts">
        <div id="post-now-heading">
          <span>
            Post
          </span>
        </div>


        <!--form-->
        <div id="post-form-div">
          <form action="/posts/create" id="new-post-form" method="POST">
            <textarea name="content" cols="50" rows="3" placeholder="What's on your mind?....." required></textarea>
            <input id="postBtn" type="submit" value="Post">
          </form>
        </div>      
        <!--recent posts-->
        
        <div id="recent-posts-heading">
          <span>
            Recent posts
          </span>
        </div>

        <div id="posts-list-container">
          <ul>
              <% for(post of posts) { %>                
                  <%- include('_post') -%>
              <% } %>
          </ul>
          <hr>
        </div>

       </div>



       <div id="display-users-div">

          <div id="friends-div">

            <div id="heading-friends">
              <i class="fas fa-user-friends">

              </i>
              <span>
                Friends
              </span>
            </div>

            <div id="friends-list-div">
              <% for(u of all_friends) { %>
                <% if(u.id != locals.user.id) { %>
                  <div class="user-friend-div">
                    <!-- <i class="fas fa-paper-plane">

                    </i> -->
                    <a href="/users/profile/<%= u.id %>">
                      <%= u.name %>
                    </a>
                  </div>
                <% } %>
              <% } %>
            </div>
          </div>

          <div id="non-friends-div">
            <div id="heading-non-friends">
              <i class="fas fa-user-friends">

              </i>
              <span>
                Other users
              </span>
            </div>

            <div id="non-friends-list-div">
              <% for(u of all_non_friends) { %>
                <% if(u.id != locals.user.id) { %>
                  <div class="user-friend-div">
                    <a href="/users/profile/<%= u.id %>">
                      <%= u.name %>
                    </a>
                  </div>
                <% } %>
              <% } %>
            </div>

          </div>

       </div>

      </div>
   
    <% } %>

    <!--render front page if user is not logged in-->
    <% if(!locals.user) { %>
      
        <section id="hero" class="d-flex align-items-center">
            <div class="container position-relative" data-aos="fade-up" data-aos-delay="100">
              <div class="row justify-content-center">
                <div class="col-xl-7 col-lg-9 text-center">
                  <h1> friendlite </h1>
                  <h2> See what your friends are upto! </h2>
                </div>
              </div>
              <div class="text-center">
                <div style="display:inline-block;" class="text-center">
                  <a href="/users/sign-in" class="btn-get-started scrollto"> Sign In </a>
                </div>
                <div style="display: inline-block;" class="text-center">
                  <a href="/users/sign-up" class="btn-get-started scrollto"> Sign Up </a>
                </div>
              </div>
        
              <div class="row icon-boxes">
                <div class="col-md-6 col-lg-3 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="200">
                  <div class="icon-box">
                    <div class="icon"><i class="ri-stack-line"></i></div>
                    <h4 class="title"><a href=""> Keep track of your friends </a></h4>
                    <p class="description">Who doesnt want to know what their friends are doing?
                      friendlite does just that!
                    </p>
                  </div>
                </div>
        
                <div class="col-md-6 col-lg-3 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="300">
                  <div class="icon-box">
                    <div class="icon"><i class="ri-palette-line"></i></div>
                    <h4 class="title"><a href=""> Let everyone what you are upto! </a></h4>
                    <p class="description">Tell people where and what you are cooking. Post exciting stuff about yourself!</p>
                  </div>
                </div>
        
                <div class="col-md-6 col-lg-3 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="400">
                  <div class="icon-box">
                    <div class="icon"><i class="ri-command-line"></i></div>
                    <h4 class="title"><a href=""> Chat with your friends </a></h4>
                    <p class="description">Now chat real time with your friends!</p>
                  </div>
                </div>
        
                <div class="col-md-6 col-lg-3 d-flex align-items-stretch mb-5 mb-lg-0" data-aos="zoom-in" data-aos-delay="500">
                  <div class="icon-box">
                    <div class="icon"><i class="ri-fingerprint-line"></i></div>
                    <h4 class="title"><a href=""> Register now on friendlite </a></h4>
                    <p class="description">Register now, your one and only app that is totally free!</p>
                  </div>
                </div>
        
              </div>
            </div>
          </section><!-- End Hero -->
        
          <main id="main">
        
            <!-- ======= About Section ======= -->
            <section id="about" class="about">
              <div class="container" data-aos="fade-up">
        
                <div class="section-title">
                  <h1>About friendlite </h1>
                  <p> Welcome to friendlite, a social media platform that I built as a project </p>
                </div>
        
                <div class="row content">
                  <div class="col-lg-6">

                    <ul>
                      <li><i class="ri-check-double-line"></i> Secure login and logout using passport and cookies</li>
                      <li><i class="ri-check-double-line"></i> Comment and post to tell your friends what you are upto</li>
                      <li><i class="ri-check-double-line"></i> Chit chat with your friends anytime! </li>
                    </ul>
                  </div>
                  <div class="col-lg-6 pt-4 pt-lg-0">
                    <p>
                      I am a third year undergraduate Computer Science student at Indian Institute of Technology Kharagpur.
                      I have built this website as a part of the course on full stack web developement in Nodejs. Hope you like it! 
                    </p>
                    <a href="#" class="btn-learn-more">Learn More</a>
                  </div>
                </div>
        
              </div>
            </section><!-- End About Section -->
        
    <% } %>

<script src="/js/home_post_comments.js"></script>
<script src="/js/home_posts.js"></script>

<script src="/js/toggle_likes.js"></script>
<script>
    $('.toggle-like-button').each(function() {
        let self = this;
        let toggleLike = new ToggleLike(self);
    });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
<script src="/js/chat_engine.js"></script>

<% if(locals.user) { %>
    <script>
        new ChatEngine('user-chat-box', '<%=locals.user.email%>');
    </script>
<% } %>